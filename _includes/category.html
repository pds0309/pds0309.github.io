
<article class="post">
	<header class="post-header home">
		<div class="post-title"><span id='category-name'></span></div>
	</header>
	<div>
		<div id="addTag"> 
			
		</div>
	</div>
</article>

<article class="post">
	<div class="post-content">
		
		{%- if site.posts.size > 0 -%}
		{%- for post in site.posts -%}
		<div class="post-list">
			<div class="mypost post-list-item post-category-{{post.categories}} post-mytag-{{post.mytag}}">
				{% if post.img %}
    			<a class="mypost-thumbnail" style="background-image: url({{"/assets/img/" | prepend: site.url | append : post.img}})" href="{{post.url | prepend: site.url}}"></a>
  				{% else %}
  				{% endif %}
				  <div class="mypost-content">
				  <h2 class="mypost-title"><a href="{{post.url | prepend: site.url}}">{{post.title}}</a></h2>
				  
				  <p>{{ post.content | strip_html | truncatewords: 18 }}</p>
				  {% for t in post.mytag %}<span style="color:blue" class="mytag post-category-{{post.categories}}">#{{t}}.</span>{% endfor %}
				  {%- assign date_format = "%Y/%m/%d" -%}
				  <div class="mypost-date">{{post.date | date: '%Y, %b %d'}}&nbsp;&nbsp;&nbsp;
				  {%- if site.show_excerpts -%}{{ post.excerpt }}{%- endif -%}</div>&nbsp;
					</div>
				<!-- {%- assign date_format = site.date_format | default: "%b %-d, %Y" -%} -->
			</div>
		</div>
		{%- endfor -%}
	  	{%- endif -%}
	</div>
</article>


<script src="/public/js/jquery-3.4.1.slim.min.js"></script>
<script>
	function myTagSplit(myt){
		var str = myt.textContent;
		str = str.split('#');
		str = str[1];
		var a = str.indexOf('.');
		var b = str.substring(0,a);
		return b;
	}
	function removeCategory() {
		if (window.location.hash) {
			
			let hash = window.location.hash.substring(1);
			$('#category-name').text(hash.substring(0, 1).toUpperCase() + hash.substring(1));
			let category_class = '.post-category-' + hash;
			let items = $('.post-list-item').each((i, e) => {
				if (!$(e).hasClass('post-category-' + hash)) {
					$(e).hide();
				} else {
					$(e).show();					
				}
			});
			var map = new HashMap();
			var tags = $('.mytag').each((i,f)=>{
				if ($(f).hasClass('post-category-' + hash)) {
				var b = myTagSplit(f);
				if(map.get(b)==null){
					map.put(b, 1);
				}
				else{
					map.put(b , map.get(b)+1);
				}
				}
				});
			let allTemp = map.getAll();
			$('#addTag').html('');
			
        	for(i in allTemp){$('#addTag').append(
			'<a href="#" class="button2" id='+i+' onclick="filterTag(this)">'+i.toUpperCase()+' (' + map.get(i) + ')</button>'
			).append("   ")} 
		}
		
        

	}
	$(window).on('hashchange', () => {
		removeCategory();
	});
	$(document).ready(() => {
		removeCategory();
	})
	
	HashMap = function(){  
    this.map = new Array();
	};  
	HashMap.prototype = {  
    put : function(key, value){  
        this.map[key] = value;
    },  
    get : function(key){  
        return this.map[key];
    },  
    getAll : function(){  
        return this.map;
    },  
    clear : function(){  
        this.map = new Array();
    },  
    isEmpty : function(){    
         return (this.map.size() == 0);
    },
    remove : function(key){    
         delete this.map[key];
    },
    toString : function(){
        var temp = '';
        for(i in this.map){  
            temp = temp + ',' + i + ':' +  this.map[i];
        }
        temp = temp.replace(',','');
          return temp;
    },
    keySet : function(){  
        var keys = new Array();  
        for(i in this.map){  
            keys.push(i);
        }  
        return keys;
    }
	};
	function filterTag(now){
		let btnID = document.getElementById(now.getAttribute('id')).getAttribute('id');
		let hash = window.location.hash.substring(1);
		let items = $('.post-list-item').each((i, e) => {
			if (!$(e).hasClass('post-category-' + hash)) {
				$(e).hide();
				} 
				else 
				{
					var t = e.textContent;
					if(t.indexOf("#" + btnID) != -1){
						$(e).show();
					}
					else{
						$(e).hide();

					}
				}
		});
	}
	
</script>